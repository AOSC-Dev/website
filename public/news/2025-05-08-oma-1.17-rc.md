---
categories:
  - advisories
title: "小熊猫包管理 (oma) v1.17 测试公告"
date: 2025-05-08T22:00:00+08:00
important: true
home: true
---

![啊噫——！](/assets/news/oma-1.17.png)
> 啊噫——！

小熊猫包管理 (oma) v1.17 来啦！本版更新，我们大幅度增强了 oma 的磁盘占用管理功能，不仅引入了磁盘占用分析器，还新增了磁盘将满警告，在发出预警的同时指引您清理无需使用的软件包和缓存数据。此外，oma 1.17 还引入了 Zsh 补全、阅读器 Emacs 键位支持和调试日志记录功能等新特性。

让我们来一起详细了解本版 oma 的新特性和修复吧～     


新特性一览
---

### 一目了然：软件包磁盘占用分析器

![全新引入的软件包磁盘占用管理器](/assets/news/oma-size-analyzer-tui.png)
> 全新引入的软件包磁盘占用管理器

软件包是组成操作系统的基本单位，而在系统使用一段时间后，相信用户朋友们也会发现，磁盘空间愈发紧张：随着系统更新和日常使用，无用软件包、下载缓存等都将占据不少的空间。oma 1.17 引入的软件包磁盘占用分析器 (`oma size-analyzer`) 功能相信可以帮助您更清晰地了解软件包的磁盘占用情况，协助您删除不必要的软件包，节省空间。

除展示软件包的占用情况外，占用分析器还支持快捷清理无用依赖，也可以直接从列表选中要卸载的软件包。

### 前方注意！磁盘将满预警

![磁盘将满时，oma 会提示您清理无用软件及软件包缓存](/assets/news/oma-space-warning.png)
> 磁盘将满时，oma 会提示您清理无用软件及软件包缓存

最近，一名用户报告：在使用 oma 更新时磁盘被占满，导致 dpkg 报错且软件包状态损坏。作为预防，oma 1.17 引入了磁盘将满预警，在磁盘可用空间小于 5GiB 时报警，并给出各种腾出空间的提示和指引。

当然，提醒用户还是不够的：oma 和 APT 实际上均未能精确地计算软件包更新时所需的磁盘空间，因此上述故障还是可能出现的。我们将在下一周期着手调查并优化磁盘空间占用的检查逻辑，杜绝上述故障的出现。

### Zsh 补全支持

![oma 的 Zsh 补全](/assets/news/oma-zsh-completion.png)
> oma 的 Zsh 补全

得益于命令行选项解析器 Clap 引入的动态补全功能，oma 1.17 终于引入了 Zsh 补全功能，方便各位 Zsh 用户使用。

### 其他新特性

- TUI 及阅读器新增 Emacs 键位支持（感谢 @guanran928！）
- 新增 `-t/--download-threads` 选项，可用于自定义下载线程数（等效于 `/etc/oma.toml` 中的 `network_threads` 选项）
- 新增日志记录功能，便利出现故障时的现场调试。

问题修复
---

- 修复在搭配 `--color always` 参数使用 oma 时，写入日志到文件不显示颜色的问题
- 修复 `/etc/oma.toml` 中的 `network_threads` 设置未 0 时，运行 oma 下载软件包会卡死的问题

测试指南
---

安同 OS 可通过如下命令获取 oma 1.17 测试版更新：

```bash
oma topics --opt-in oma-1.17.0-rc.3
```

Debian、Ubuntu 及衍生版，Linux Mint、deepin 及 openKylin 用户可通过如下命令获取 oma（目前暂未区分测试源及稳定源，可直接获取 1.17 版更新）：

```bash
curl -sSf https://repo.aosc.io/get-oma.sh | sudo sh
```

如果您在测试 oma 的过程中遇到问题或有任何建议，欢迎您来我社[各聊天群组](https://aosc.io/contact)与我们联系反馈。
